<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adminbereich - haertfelder.me</title>
<style>
body { font-family: system-ui, sans-serif; margin:0; padding:2rem; background:#f4f4f9; color:#222;}
header { display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem; flex-wrap:wrap;}
h1 { margin:0; }
button { background:#007bff; color:white; padding:0.6rem 1rem; border:none; border-radius:6px; cursor:pointer; font-size:1rem; margin-top:0.3rem;}
button:hover { background:#0056b3; }
.delete-btn { background:#dc3545; }
.delete-btn:hover { background:#a71d2a; }
.card { background:#fff; border-radius:12px; padding:1.5rem; box-shadow:0 2px 6px rgba(0,0,0,0.2); margin-bottom:1.5rem;}
.post { border-bottom:1px solid #ddd; padding:0.5rem 0;}
.post strong { display:block; margin-bottom:0.3rem;}
input, textarea { width:100%; margin-bottom:0.5rem; padding:0.5rem; border-radius:6px; border:1px solid #ccc; font-size:1rem; }
.rating button { margin-right:0.5rem; cursor:pointer;}
.comment { background:#2a2a2a; color:#fff; padding:0.4rem; border-radius:6px; margin-bottom:0.5rem; font-size:0.9rem;}
@media(max-width:600px){
  header { flex-direction:column; gap:0.5rem; }
  button { width:100%; }
}
</style>
</head>
<body>
<header>
<h1>Adminbereich</h1>
<button onclick="logout()">🚪 Logout</button>
</header>

<div class="card">
<h2>Neuen Blogeintrag erstellen</h2>
<form onsubmit="addPost(event)">
  <input type="text" id="postTitle" placeholder="Titel" required>
  <textarea id="postText" placeholder="Dein Text..." required></textarea>
  <button type="submit">➕ Erstellen</button>
</form>
</div>

<div class="card">
<h2>Alle Blogeinträge</h2>
<div id="blogList"></div>
</div>

<script>
// Admin-Schutz
if(sessionStorage.getItem("isAdmin")!=="true"){ alert("Kein Zugriff!"); window.location.href="index.html"; }

function addPost(event){
  event.preventDefault();
  const title=document.getElementById("postTitle").value.trim();
  const text=document.getElementById("postText").value.trim();
  if(!title||!text) return;
  const posts=JSON.parse(localStorage.getItem("blogPosts")||"[]");
  posts.push({title,text,up:0,down:0,comments:[],rated:{}});
  savePosts(posts);
  document.getElementById("postTitle").value="";
  document.getElementById("postText").value="";
  loadBlog();
}

function loadBlog(){
  const blogList=document.getElementById("blogList");
  blogList.innerHTML="";
  const posts=JSON.parse(localStorage.getItem("blogPosts")||"[]");
  posts.forEach((post,index)=>{
    const div=document.createElement("div"); div.className="post";
    const strong=document.createElement("strong"); strong.textContent=post.title;
    const p=document.createElement("p"); p.textContent=post.text;

    // Kommentare anzeigen
    const commentList=document.createElement("div");
    (post.comments||[]).forEach(c=>{
      const commentDiv=document.createElement("div");
      commentDiv.className="comment";
      commentDiv.textContent=`${c.name}: ${c.text}`;
      commentList.appendChild(commentDiv);
    });

    // Up/Down Votes
    const ratingDiv=document.createElement("div"); ratingDiv.className="rating";
    const upBtn=document.createElement("button"); upBtn.textContent=`👍 ${post.up||0}`;
    const downBtn=document.createElement("button"); downBtn.textContent=`👎 ${post.down||0}`;
    ratingDiv.appendChild(upBtn); ratingDiv.appendChild(downBtn);

    // Löschen
    const delBtn=document.createElement("button"); delBtn.textContent="🗑️ Löschen"; delBtn.className="delete-btn";
    delBtn.onclick=()=>{ if(confirm("Diesen Blogeintrag wirklich löschen?")){ posts.splice(index,1); savePosts(posts); loadBlog(); } }

    div.appendChild(strong); div.appendChild(p); div.appendChild(commentList); div.appendChild(ratingDiv); div.appendChild(delBtn);
    blogList.appendChild(div);
  });
}

function savePosts(posts){ localStorage.setItem("blogPosts",JSON.stringify(posts)); }
function logout(){ sessionStorage.removeItem("isAdmin"); window.location.href="index.html"; }

document.addEventListener("DOMContentLoaded", loadBlog);
</script>
</body>
</html>
